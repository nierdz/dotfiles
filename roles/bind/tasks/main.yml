---
- name: Install bind9
  become: true
  apt:
    name: bind9
    state: present
  register: bind9_installed
  until: bind9_installed is success
  retries: 10
  delay: 2

- name: Configure bind9 options
  become: true
  template:
    src: etc/bind/named.conf.options.j2
    dest: /etc/bind/named.conf.options
    owner: root
    group: bind
    mode: 0644
  notify:
    - restart bind9

- name: Start bind9 at boot
  become: true
  service:
    name: bind9
    enabled: true
    state: started
